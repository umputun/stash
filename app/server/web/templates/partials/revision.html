{{define "revision"}}
<div class="modal-header">
    <h2>Revision: {{.Key}}</h2>
    <div class="modal-header-right">
        <span class="revision-badge">{{.RevHash}}</span>
        {{if and .Format (ne .Format "text")}}<span class="format-badge">{{.Format}}</span>{{end}}
        <button class="modal-close" onclick="hideModal('main-modal')">&times;</button>
    </div>
</div>
<div class="modal-body">
    <div class="form-group">
        <label>Key</label>
        <div class="value-display">{{.Key}}</div>
    </div>
    <div class="form-group">
        <label>Value at revision {{.RevHash}}</label>
        {{if .IsBinary}}
        <span class="binary-indicator">Base64 encoded</span>
        <div class="value-display value-content">{{.Value}}</div>
        {{else}}
        <div class="value-display value-content highlighted-code">{{.HighlightedVal}}</div>
        {{end}}
    </div>
</div>
<div class="modal-footer">
    <button class="btn btn-secondary" onclick="hideModal('main-modal')">Close</button>
    <button class="btn btn-secondary"
            hx-get="{{.BaseURL}}/web/keys/history/{{.Key | urlEncode}}"
            hx-target="#modal-content"
            hx-swap="innerHTML">Back to History</button>
    {{if .CanWrite}}
    <button class="btn btn-primary"
            hx-post="{{.BaseURL}}/web/keys/restore/{{.Key | urlEncode}}"
            hx-vals='{"rev": "{{.RevHash}}"}'
            hx-target="#keys-table"
            hx-swap="innerHTML"
            onclick="hideModal('main-modal')">Restore This Version</button>
    {{end}}
</div>
<style>
    #main-modal .modal { --modal-width: {{.ModalWidth}}px; }
    #main-modal .value-content { min-height: {{.TextareaHeight}}px; }
</style>
{{end}}
